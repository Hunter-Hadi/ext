const oldFetch = window.fetch
window.fetch = async function (t, e) {
  if (!t.toString().includes('https://chat.openai.com')) return oldFetch(t, e)
  if ('https://chat.openai.com/api/auth/session' === t) {
    let o = await oldFetch(t, e),
      s = await o.text(),
      a = s
    try {
      console.log('set session'),
        window.sessionStorage.setItem(
          'openai_session',
          JSON.parse(a).accessToken,
        )
    } catch (c) {
      console.log(c)
    }
    return new Response(a, o)
  }
  if ('https://chat.openai.com/backend-api/models' === t) {
    let n = await oldFetch(t, e),
      i = await n.text()
    try {
      console.log('set models'),
        window.sessionStorage.setItem('openai_models', i)
    } catch (h) {
      console.log(h)
    }
    return new Response(i, n)
  }
  return oldFetch(t, e)
}
